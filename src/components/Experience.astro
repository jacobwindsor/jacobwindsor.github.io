---
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card';
import { Badge } from '@/components/ui/badge';
import { Calendar, MapPin } from 'lucide-react';
---

<section id="experience" class="py-20 px-6 lg:px-8 bg-background">
  <div class="container mx-auto max-w-6xl">
    <div class="text-center mb-16">
      <h2 class="text-4xl lg:text-5xl font-semibold mb-4 text-foreground tracking-tight">
        Experience
      </h2>
      <div class="w-12 h-px bg-primary mx-auto mb-6"></div>
      <p class="text-base text-muted-foreground max-w-2xl mx-auto font-light">
        Building scalable engineering solutions in life sciences
      </p>
    </div>

    <!-- Timeline Container -->
    <div class="relative">
      <!-- Timeline Line - Only visible on desktop -->
      <div class="hidden lg:block absolute left-1/2 transform -translate-x-1/2 top-0 bottom-0 w-px bg-border/40"></div>

      <!-- Timeline Items -->
      <div class="space-y-10 lg:space-y-12">
        <!-- Human Cell Atlas - Current/Most Recent -->
        <div class="relative flex items-center timeline-item">
          <!-- Timeline Dot -->
          <div class="hidden lg:flex absolute left-1/2 transform -translate-x-1/2 z-10 w-3 h-3 rounded-full bg-primary border-2 border-background timeline-dot"></div>
          
          <!-- Content Card -->
          <div class="w-full lg:w-[calc(50%-2rem)] lg:ml-auto lg:pl-8">
            <Card className="border border-border/50 hover:border-primary/30 transition-colors bg-card">
              <CardHeader>
                <div class="space-y-3">
                  <div class="flex items-start justify-between gap-4">
                    <div class="flex-1">
                      <div class="flex items-center gap-2 mb-1.5">
                        <span class="text-xs font-medium text-primary uppercase tracking-wide">Present</span>
                      </div>
                      <CardTitle className="text-lg font-semibold mb-1">Software Engineer</CardTitle>
                      <CardDescription className="text-sm font-medium text-foreground/80">
                        Human Cell Atlas | European Bioinformatics Institute (EMBL-EBI)
                      </CardDescription>
                    </div>
                  </div>
                  <div class="flex flex-wrap items-center gap-4 text-sm text-muted-foreground pt-2 border-t border-border/50">
                    <div class="flex items-center gap-2">
                      <Calendar client:load className="w-3.5 h-3.5" />
                      <span>Oct 2020 - Present</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <MapPin client:load className="w-3.5 h-3.5" />
                      <span>Cambridge, UK</span>
                    </div>
                  </div>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                <p class="text-sm text-muted-foreground leading-relaxed font-light">
                  Leading engineering efforts for the Data Coordination Platform of the <a href="https://www.humancellatlas.org/" target="_blank" rel="noopener noreferrer" class="text-primary hover:underline font-medium">Human Cell Atlas</a> â€” a global initiative creating comprehensive reference maps of all human cells. Building scalable infrastructure that processes petabytes of single-cell genomics data and supports thousands of researchers worldwide.
                </p>
                <div class="flex flex-wrap gap-2">
                  <Badge variant="secondary" className="text-xs">Full-Stack Development</Badge>
                  <Badge variant="secondary" className="text-xs">Data Platform Architecture</Badge>
                  <Badge variant="secondary" className="text-xs">Kubernetes</Badge>
                  <Badge variant="secondary" className="text-xs">Cloud Infrastructure</Badge>
                  <Badge variant="secondary" className="text-xs">CI/CD</Badge>
                  <Badge variant="secondary" className="text-xs">TypeScript</Badge>
                  <Badge variant="secondary" className="text-xs">Java</Badge>
                  <Badge variant="secondary" className="text-xs">Angular</Badge>
                </div>
              </CardContent>
            </Card>
          </div>
        </div>

        <!-- CRG -->
        <div class="relative flex items-center timeline-item timeline-item-delay-1">
          <!-- Timeline Dot -->
          <div class="hidden lg:flex absolute left-1/2 transform -translate-x-1/2 z-10 w-3 h-3 rounded-full bg-border/60 border-2 border-background timeline-dot"></div>
          
          <!-- Content Card -->
          <div class="w-full lg:w-[calc(50%-2rem)] lg:pr-8">
            <Card className="border border-border/50 hover:border-primary/30 transition-colors bg-card">
              <CardHeader>
                <div class="space-y-3">
                  <div class="flex items-start justify-between gap-4">
                    <div class="flex-1">
                      <CardTitle className="text-lg font-semibold mb-1">Bioinformatics Researcher</CardTitle>
                      <CardDescription className="text-sm font-medium text-foreground/80">
                        Centre for Genomic Regulation
                      </CardDescription>
                    </div>
                  </div>
                  <div class="flex flex-wrap items-center gap-4 text-sm text-muted-foreground pt-2 border-t border-border/50">
                    <div class="flex items-center gap-2">
                      <Calendar client:load className="w-3.5 h-3.5" />
                      <span>Sep 2019 - Sep 2020</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <MapPin client:load className="w-3.5 h-3.5" />
                      <span>Barcelona, Spain</span>
                    </div>
                  </div>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                <p class="text-sm text-muted-foreground leading-relaxed font-light">
                  Developed innovative tools for long-read RNA sequencing analysis, creating <a href="https://github.com/jacobwindsor/tmerge" target="_blank" rel="noopener noreferrer" class="text-primary hover:underline font-medium">tmerge</a> and <a href="https://github.com/jacobwindsor/SQANTIExplorer" target="_blank" rel="noopener noreferrer" class="text-primary hover:underline font-medium">SQANTI Explorer</a>. Built scalable bioinformatics pipelines that improved transcriptome analysis accuracy. Work published in peer-reviewed journals.
                </p>
                <div class="flex flex-wrap gap-2">
                  <Badge variant="secondary" className="text-xs">Bioinformatics</Badge>
                  <Badge variant="secondary" className="text-xs">Python</Badge>
                  <Badge variant="secondary" className="text-xs">R</Badge>
                  <Badge variant="secondary" className="text-xs">Nextflow</Badge>
                  <Badge variant="secondary" className="text-xs">RNA-Seq Analysis</Badge>
                  <Badge variant="secondary" className="text-xs">Docker</Badge>
                </div>
              </CardContent>
            </Card>
          </div>
        </div>

        <!-- Abcam -->
        <div class="relative flex items-center timeline-item timeline-item-delay-2">
          <!-- Timeline Dot -->
          <div class="hidden lg:flex absolute left-1/2 transform -translate-x-1/2 z-10 w-3 h-3 rounded-full bg-border/60 border-2 border-background timeline-dot"></div>
          
          <!-- Content Card -->
          <div class="w-full lg:w-[calc(50%-2rem)] lg:ml-auto lg:pl-8">
            <Card className="border border-border/50 hover:border-primary/30 transition-colors bg-card">
              <CardHeader>
                <div class="space-y-3">
                  <div class="flex items-start justify-between gap-4">
                    <div class="flex-1">
                      <CardTitle className="text-lg font-semibold mb-1">Software Engineer</CardTitle>
                      <CardDescription className="text-sm font-medium text-foreground/80">
                        Abcam
                      </CardDescription>
                    </div>
                  </div>
                  <div class="flex flex-wrap items-center gap-4 text-sm text-muted-foreground pt-2 border-t border-border/50">
                    <div class="flex items-center gap-2">
                      <Calendar client:load className="w-3.5 h-3.5" />
                      <span>Nov 2017 - Jan 2019</span>
                    </div>
                    <div class="flex items-center gap-2">
                      <MapPin client:load className="w-3.5 h-3.5" />
                      <span>Cambridge, UK</span>
                    </div>
                  </div>
                </div>
              </CardHeader>
              <CardContent className="space-y-4">
                <p class="text-sm text-muted-foreground leading-relaxed font-light">
                  Led front-end modernization for <a href="http://www.abcam.com" target="_blank" rel="noopener noreferrer" class="text-primary hover:underline font-medium">abcam.com</a>, a platform serving millions of researchers. Architected and implemented modern JavaScript practices, migrating to Webpack and introducing functional programming patterns. Mentored team members and established engineering best practices.
                </p>
                <div class="flex flex-wrap gap-2">
                  <Badge variant="secondary" className="text-xs">Frontend Architecture</Badge>
                  <Badge variant="secondary" className="text-xs">JavaScript</Badge>
                  <Badge variant="secondary" className="text-xs">React</Badge>
                  <Badge variant="secondary" className="text-xs">Webpack</Badge>
                  <Badge variant="secondary" className="text-xs">Team Leadership</Badge>
                </div>
              </CardContent>
            </Card>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<script>
  // Smooth scroll animations for timeline items
  document.addEventListener('DOMContentLoaded', () => {
    const observerOptions = {
      threshold: 0.1,
      rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
      entries.forEach(entry => {
        if (entry.isIntersecting) {
          entry.target.classList.add('is-visible');
          observer.unobserve(entry.target);
        }
      });
    }, observerOptions);

    // Observe all timeline items
    const timelineItems = document.querySelectorAll('.timeline-item');
    timelineItems.forEach(item => {
      observer.observe(item);
    });
  });
</script>

<style>
  .timeline-item {
    opacity: 0;
    transform: translateY(1.5rem);
    transition: opacity 0.8s cubic-bezier(0.4, 0, 0.2, 1), transform 0.8s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .timeline-item.is-visible {
    opacity: 1;
    transform: translateY(0);
  }

  /* Staggered delays for sequential animation */
  .timeline-item-delay-1 {
    transition-delay: 0ms;
  }

  .timeline-item-delay-1.is-visible {
    transition-delay: 150ms;
  }

  .timeline-item-delay-2 {
    transition-delay: 0ms;
  }

  .timeline-item-delay-2.is-visible {
    transition-delay: 300ms;
  }

  /* Timeline dot animation */
  .timeline-dot {
    opacity: 0;
    transform: scale(0);
    transition: opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1), transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .timeline-item.is-visible .timeline-dot {
    opacity: 1;
    transform: scale(1);
    transition-delay: 0.3s;
  }
</style>

